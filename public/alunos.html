<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Cadastro de Alunos</title>
</head>
<body>
  <h1>Cadastro de Alunos</h1>

  <h2>Inserir Aluno</h2>
  <input type="text" id="alunoNome" placeholder="Nome do aluno">
  <input type="number" id="alunoTurmaId" placeholder="ID da turma">
  <button onclick="inserirAluno()">Inserir</button>

  <h2>Listar Alunos</h2>
  <button onclick="listarAlunos()">Ver Todos</button>
  <input type="number" id="buscaTurma" placeholder="ID da turma">
  <input type="text" id="buscaNome" placeholder="Nome do aluno">
  <button onclick="listarPorTurma()">Por Turma</button>
  <button onclick="listarPorNome()">Por Nome</button>

  <h2>Alterar Aluno</h2>
  <input type="number" id="alunoIdAlt" placeholder="ID do aluno">
  <input type="text" id="alunoNomeAlt" placeholder="Novo nome (opcional)">
  <input type="number" id="alunoTurmaAlt" placeholder="Novo ID da turma (opcional)">
  <button onclick="alterarAluno()">Alterar</button>

  <h2>Deletar Aluno</h2>
  <input type="number" id="alunoIdDel" placeholder="ID do aluno">
  <button onclick="deletarAluno()">Deletar</button>

  <h2>Resultado</h2>
  <pre id="resultado"></pre>

  <script>
    async function inserirAluno() {
      const nome = document.getElementById('alunoNome').value.trim();
      const turmaId = Number(document.getElementById('alunoTurmaId').value);
      if (!nome || !turmaId) return;
      await fetch('/alunos', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({nome, turmaId}) });
      listarAlunos();
      document.getElementById('alunoNome').value = '';
      document.getElementById('alunoTurmaId').value = '';
    }

    async function listarAlunos() {
      const res = await fetch('/alunos');
      const data = await res.json();
      document.getElementById('resultado').textContent = JSON.stringify(data, null, 2);
    }

    async function listarPorTurma() {
      const id = document.getElementById('buscaTurma').value;
      if (!id) return;
      const res = await fetch(`/alunos/turma/${id}`);
      const data = await res.json();
      document.getElementById('resultado').textContent = JSON.stringify(data, null, 2);
      document.getElementById('buscaTurma').value = '';
    }

    async function listarPorNome() {
      const nome = document.getElementById('buscaNome').value.trim();
      if (!nome) return;
      const res = await fetch(`/alunos/nome/${nome}`);
      const data = await res.json();
      document.getElementById('resultado').textContent = JSON.stringify(data, null, 2);
      document.getElementById('buscaNome').value = '';
    }

    async function alterarAluno() {
      const id = Number(document.getElementById('alunoIdAlt').value);
      const nome = document.getElementById('alunoNomeAlt').value.trim();
      const turmaId = Number(document.getElementById('alunoTurmaAlt').value);
      await fetch(`/alunos/${id}`, { method:'PUT', headers:{'Content-Type':'application/json'}, body: JSON.stringify({nome, turmaId}) });
      listarAlunos();
      document.getElementById('alunoIdAlt').value = '';
      document.getElementById('alunoNomeAlt').value = '';
      document.getElementById('alunoTurmaAlt').value = '';
    }

    async function deletarAluno() {
      const id = Number(document.getElementById('alunoIdDel').value);
      await fetch(`/alunos/${id}`, { method:'DELETE' });
      listarAlunos();
      document.getElementById('alunoIdDel').value = '';
    }
  </script>
</body>
</html>