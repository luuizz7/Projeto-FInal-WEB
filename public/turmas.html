<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Cadastro de Turmas</title>
</head>
<body>
  <h1>Cadastro de Turmas</h1>

  <h2>Inserir Turma</h2>
  <input type="text" id="turmaNome" placeholder="Nome da turma">
  <button onclick="inserirTurma()">Inserir</button>

  <h2>Listar Turmas</h2>
  <button onclick="listarTurmas()">Ver Todas</button>
  <button onclick="listarTurmasComAlunos()">Ver Turmas + Alunos</button>

  <h2>Alterar Turma</h2>
  <input type="number" id="turmaIdAlt" placeholder="ID da turma">
  <input type="text" id="turmaNomeAlt" placeholder="Novo nome">
  <button onclick="alterarTurma()">Alterar</button>

  <h2>Deletar Turma</h2>
  <input type="number" id="turmaIdDel" placeholder="ID da turma">
  <button onclick="deletarTurma()">Deletar</button>

  <h2>Resultado</h2>
  <pre id="resultado"></pre>

  <script>
    async function inserirTurma() {
      const nome = document.getElementById('turmaNome').value.trim();
      if (!nome) return;
      await fetch('/turmas', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({nome}) });
      listarTurmas();
      document.getElementById('turmaNome').value = '';
    }

    async function listarTurmas() {
      const res = await fetch('/turmas');
      const data = await res.json();
      document.getElementById('resultado').textContent = JSON.stringify(data, null, 2);
    }

    async function listarTurmasComAlunos() {
      const res = await fetch('/turmas/com-alunos');
      const data = await res.json();
      document.getElementById('resultado').textContent = JSON.stringify(data, null, 2);
    }

    async function alterarTurma() {
      const id = Number(document.getElementById('turmaIdAlt').value);
      const nome = document.getElementById('turmaNomeAlt').value.trim();
      await fetch(`/turmas/${id}`, { method:'PUT', headers:{'Content-Type':'application/json'}, body: JSON.stringify({nome}) });
      listarTurmas();
      document.getElementById('turmaIdAlt').value = '';
      document.getElementById('turmaNomeAlt').value = '';
    }

    async function deletarTurma() {
      const id = Number(document.getElementById('turmaIdDel').value);
      await fetch(`/turmas/${id}`, { method:'DELETE' });
      listarTurmas();
      document.getElementById('turmaIdDel').value = '';
    }
  </script>
</body>
</html>
